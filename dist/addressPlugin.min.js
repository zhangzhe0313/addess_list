!function(s,i,t){function e(i,t){this.el=i,this.opts={datas:t.datas||[],title:t.title||"请选择",titlePos:t.titlePos||"center",showColumn:t.showColumn||3,showAll:t.showAll||0,defaultValue:t.defaultValue||null,callback:t.callback||void 0},0!=this.opts.datas.length&&(provinceObj={},cityList=[],cityObj={},zoonList=[],zoonObj={},finalProvince={},finalCity={},finalZoon={},finalCityList=[],finalZoonList=[],apProvinceTitleObj=null,apCityTitleObj=null,apZoonTitleObj=null,apPCZListObj=null,this.init(),this.openModule=function(){s("#addressModule").css("display","block"),s("#addressList").removeClass("ap-pop-out").addClass("ap-pop-in")})}ANIMATION_OUT=300,MAX_SHOW_ITEMNUM=10,ITEM_HEIGHT=30,e.prototype={constructor:e,init:function(){this.drawDom(),this.handleEvent()},drawDom:function(){var i=this,t="",e="";if("left"==i.opts.titlePos?e='<div class="ap-title-wrap" style="text-align: left; padding-left: .4rem;">':"center"==i.opts.titlePos&&(e='<div class="ap-title-wrap" style="text-align: '+this.opts.titlePos+'">'),t+='<div id="addressModule" class="ap-container"><div id="addressList" class="ap-addrlist"><div class="ap-title">'+e+'<div class="ap-title-content">'+i.opts.title+'</div><div id="apCLose" class="ap-close"></div></div></div><div class="ap-choose-area"><div id="apChooseProvince" class="ap-choose-pcz ap-box-shaw" data-province="000000">请选择</div><div id="apChooseCity" class="ap-choose-pcz ap-none" data-city="000000">请选择</div><div id="apChooseZoon" class="ap-choose-pcz ap-none" data-zoon="000000">请选择</div></div><div id="apPCZList" class="ap-pcz-list"></div></div></div>',i.el.html(t),i.initTitleAndListObj(),i.opts.defaultValue){var a=i.opts.defaultValue.split("-");i.resetChoosedInfo(a)}else i.refreshCurrentView(i.opts.datas,"province",i.apProvinceTitleObj),i.apProvinceTitleObj.text("请选择"),i.apCityTitleObj.addClass("ap-none"),i.apZoonTitleObj.addClass("ap-none"),i.apPCZListObj.scrollTop(0)},initTitleAndListObj:function(){this.apProvinceTitleObj=s("#apChooseProvince"),this.apCityTitleObj=s("#apChooseCity"),this.apZoonTitleObj=s("#apChooseZoon"),this.apPCZListObj=s("#apPCZList")},changeTitleInfo:function(i,t,e,a){if(i){var s=!1,o=!1,n=!1;switch(i){case"province":s=!0;break;case"city":s=o=!0;break;case"zoon":s=o=n=!0}s&&(t.text(this.finalProvince.name),t.attr("data-province",this.finalProvince.code)),o&&(e.text(this.finalCity.name),e.attr("data-city",this.finalCity.code)),n&&(a.text(this.finalZoon.name),a.attr("data-zoon",this.finalZoon.code))}},setFinalPCZInfo:function(i){if(i&&0!=i.length){for(var t=0;t<this.opts.datas.length;t++)if(this.opts.datas[t].name==i[0]){this.finalProvince=this.opts.datas[t],this.provinceObj=this.finalProvince;break}if(2==i.length){this.finalCityList=this.finalProvince.children,this.cityList=this.finalCityList;for(var e=0;e<this.finalCityList.length;e++)if(this.finalCityList[e].name==i[1]){this.finalCity=this.finalCityList[e],this.cityObj=this.finalCity;break}}if(3==i.length){this.finalCityList=this.finalProvince.children,this.cityList=this.finalCityList;for(var a=0;a<this.finalCityList.length;a++)if(this.finalCityList[a].name==i[1]){this.finalCity=this.finalCityList[a],this.cityObj=this.finalCity;break}this.finalZoonList=this.finalCity.children,this.zoonList=this.finalZoonList;for(var s=0;s<this.finalZoonList.length;s++)if(this.finalZoonList[s].name==i[2]){this.finalZoon=this.finalZoonList[s],this.zoonObj=this.finalZoon;break}}}},resetChoosedInfo:function(i){this.setFinalPCZInfo(i),s.isEmptyObject(this.finalZoon)?(this.apZoonTitleObj.addClass("ap-none"),s.isEmptyObject(this.finalCity)?(this.apCityTitleObj.addClass("ap-none"),s.isEmptyObject(this.finalProvince)||(this.apProvinceTitleObj.removeClass("ap-none"),this.changeTitleInfo("province",this.apProvinceTitleObj,this.apCityTitleObj,this.apZoonTitleObj),this.setCurrentItem(this.opts.datas,"province",this.apProvinceTitleObj,this.finalProvince.code))):(this.apCityTitleObj.removeClass("ap-none"),this.apProvinceTitleObj.removeClass("ap-none"),this.changeTitleInfo("city",this.apProvinceTitleObj,this.apCityTitleObj,this.apZoonTitleObj),this.handleProvinceTitleClick(),this.setCurrentItem(this.finalCityList,"city",this.apCityTitleObj,this.finalCity.code))):(this.apProvinceTitleObj.removeClass("ap-none"),this.apCityTitleObj.removeClass("ap-none"),this.apZoonTitleObj.removeClass("ap-none"),this.changeTitleInfo("zoon",this.apProvinceTitleObj,this.apCityTitleObj,this.apZoonTitleObj),this.handleProvinceTitleClick(),this.handleCityTitleClick(),this.setCurrentItem(this.finalZoonList,"zoon",this.apZoonTitleObj,this.finalZoon.code))},closeModule:function(){s("#addressList").addClass("ap-pop-out").removeClass("ap-pop-in"),setTimeout(function(){s("#addressModule").css("display","none")},ANIMATION_OUT),s("#addressModule").remove()},rollBackStatus:function(){s(".ap-pcz-iteminner").removeClass("apitem-active"),s(".ap-chooseimg").addClass("ap-unvisible"),s(".ap-choose-pcz").removeClass("ap-box-shaw")},setPCZObject:function(i,t,e){if(i&&t&&e&&0!=e.length)for(var a=0;a<e.length;a++)switch(i){case"province":if(e[a].code==t)return void(this.provinceObj=e[a]);break;case"city":if(e[a].code==t)return void(this.cityObj=e[a]);break;case"zoon":if(e[a].code==t)return void(this.zoonObj=e[a])}},composeHtml:function(i,t,e,a,s){return i&&t&&e?"province"==e?'<div class="ap-pcz-item ap-province" data-pczid='+i+'><div class="ap-pcz-iteminner">'+t+'</div><div class="ap-chooseimg ap-unvisible"></div></div>':("city"==e&&s&&(t=a?'<div style="width: .266666rem; display: inline-block;">'+a+'</div><span style="padding-left: .32rem;">'+t+"</span>":'<div style="padding-left: .586666rem">'+t+"</div>"),'<div class="ap-pcz-item" data-pczid='+i+'><div class="ap-pcz-iteminner">'+t+'</div><div class="ap-chooseimg ap-unvisible"></div></div>'):""},rePaintDom:function(i,t,e){if(i&&0!=i.length&&t){var a="",s=this.apPCZListObj;switch(s.empty(),this.setTitleStatusOrigin(),t){case"province":for(var o=0;o<i.length;o++)1==this.opts.showAll?/^[0-9]/.test(i[o].code)&&(a+=this.composeHtml(i[o].code,i[o].name,"province")):2==this.opts.showAll?/^[A-Z]/.test(i[o].code)&&(a+=this.composeHtml(i[o].code,i[o].name,"province")):a+=this.composeHtml(i[o].code,i[o].name,"province");return s.append(a),void this.handlerProvinceItem();case"city":for(var n=0;n<i.length;n++)a+=this.composeHtml(i[n].code,i[n].name,"city",i[n].orderLetter,e);return s.append(a),void this.handlerCityItem();case"zoon":for(var l=0;l<i.length;l++)a+=this.composeHtml(i[l].code,i[l].name,"zoon");return s.append(a),void this.handlerZoonItem();default:return}}},handlePCZItemCommEvent:function(i,t,e,a){this.rollBackStatus(),i.addClass("apitem-active").removeClass("ap-box-shaw"),i.next().removeClass("ap-unvisible"),this.setPCZObject(e,i.parent().attr("data-pczid"),a);var s=i.text();t.text(s.replace(/[A-Z]/g,""))},changeActivePos:function(i){this.setTitleStatusOrigin(),i.addClass("ap-box-shaw").addClass("apitem-active")},setTitleStatusOrigin:function(){s(".ap-choose-pcz").removeClass("ap-box-shaw").removeClass("apitem-active")},refreshCurrentView:function(i,t,e){i&&0!=i.length&&t&&(this.rePaintDom(i,t,this.provinceObj&&this.provinceObj.showOrder),this.changeActivePos(e))},showOrHideTitle:function(i,t){i&&(t?i.removeClass("ap-none"):i.addClass("ap-none"))},returnChooseAddress:function(){var i=this.finalProvince&&this.finalProvince.name,t=this.finalProvince&&this.finalProvince.code,e=this.finalCity&&this.finalCity.name,a=this.finalCity&&this.finalCity.code,s=this.finalZoon&&this.finalZoon.name,o=this.finalZoon&&this.finalZoon.code,n="",l="";return i&&(n+=i,l+=t),e&&(n+="-"+e,l+="-"+a),s&&(n+="-"+s,l+="-"+o),{name:n,id:l}},setCurrentItem:function(i,t,e,a){i&&0!=i.length&&t&&0!=e.length&&a&&(this.refreshCurrentView(i,t,e),this.chooseApItem(a,i.length))},setPCZData:function(i,t,e,a,s){this.finalProvince=i||{},this.finalCity=t||{},this.finalZoon=e||{},this.finalCityList=a||[],this.finalZoonList=s||[]},handlerProvinceItem:function(){var t=this;s(".ap-pcz-iteminner").on("click",function(i){t.handlePCZItemCommEvent(s(this),t.apProvinceTitleObj,"province",t.opts.datas),t.apProvinceTitleObj.attr("data-province",t.provinceObj.code),t.cityList=t.provinceObj.children,0==t.cityList.length||1==t.opts.showColumn?(t.cityObj={},t.zoonObj={},t.setPCZData(t.provinceObj,{},{},[],[]),t.apProvinceTitleObj.addClass("apitem-active").addClass("ap-box-shaw"),t.opts.callback&&t.opts.callback(t.returnChooseAddress()),t.closeModule()):(t.rePaintDom(t.cityList,"city",t.provinceObj.showOrder),t.apCityTitleObj.removeClass("ap-none").addClass("ap-box-shaw"),t.showOrHideTitle(t.apZoonTitleObj,!1),t.apCityTitleObj.text("请选择"),t.apCityTitleObj.attr("data-city","000000"),t.apZoonTitleObj.text("请选择"),t.apZoonTitleObj.attr("data-zoon","000000"))}),t.handleProvinceTitleClick()},handleProvinceTitleClick:function(){var i=this;i.apProvinceTitleObj.on("click",function(){i.apProvinceTitleObj.hasClass("apitem-active")||i.setCurrentItem(i.opts.datas,"province",i.apProvinceTitleObj,i.apProvinceTitleObj.attr("data-province"))})},handlerCityItem:function(){var t=this;s(".ap-pcz-iteminner").on("click",function(i){t.handlePCZItemCommEvent(s(this),t.apCityTitleObj,"city",t.cityList),t.apCityTitleObj.attr("data-city",t.cityObj.code),t.zoonList=t.cityObj.children,0==t.zoonList.length||2==t.opts.showColumn?(t.setPCZData(t.provinceObj,t.cityObj,{},t.cityList,[]),t.zoonObj={},t.apCityTitleObj.addClass("apitem-active").addClass("ap-box-shaw"),t.opts.callback&&t.opts.callback(t.returnChooseAddress()),t.closeModule()):(t.rePaintDom(t.zoonList,"zoon"),t.apZoonTitleObj.removeClass("ap-none").addClass("ap-box-shaw"),t.apZoonTitleObj.text("请选择"),t.apZoonTitleObj.attr("data-zoon","000000"))}),t.handleCityTitleClick()},handleCityTitleClick:function(){var i=this;i.apCityTitleObj.on("click",function(){i.apCityTitleObj.hasClass("apitem-active")||i.setCurrentItem(i.cityList,"city",i.apCityTitleObj,i.apCityTitleObj.attr("data-city"))})},handlerZoonItem:function(){var t=this;s(".ap-pcz-iteminner").on("click",function(i){t.handlePCZItemCommEvent(s(this),t.apZoonTitleObj,"zoon",t.zoonList),t.apZoonTitleObj.addClass("apitem-active").addClass("ap-box-shaw"),t.apZoonTitleObj.attr("data-zoon",t.zoonObj.code),t.setPCZData(t.provinceObj,t.cityObj,t.zoonObj,t.cityList,t.zoonList),t.opts.callback&&t.opts.callback(t.returnChooseAddress()),t.closeModule()}),t.apZoonTitleObj.on("click",function(){t.apZoonTitleObj.hasClass("apitem-active")||t.setCurrentItem(t.zoonList,"zoon",t.apZoonTitleObj,t.apZoonTitleObj.attr("data-zoon"))})},chooseApItem:function(i,t){if(i&&"000000"!=i){var e=s("[data-pczid="+i+"]"),a=e.index()+1;e.children().eq(0).addClass("apitem-active"),e.children().eq(1).removeClass("ap-unvisible"),t>MAX_SHOW_ITEMNUM&&(a<MAX_SHOW_ITEMNUM?a<=t-MAX_SHOW_ITEMNUM?this.apPCZListObj.scrollTop((a-1)*ITEM_HEIGHT):this.apPCZListObj.scrollTop((t-MAX_SHOW_ITEMNUM)*ITEM_HEIGHT):t-a>MAX_SHOW_ITEMNUM-1?this.apPCZListObj.scrollTop(MAX_SHOW_ITEMNUM*parseInt(t/MAX_SHOW_ITEMNUM)*ITEM_HEIGHT):this.apPCZListObj.scrollTop(MAX_SHOW_ITEMNUM*ITEM_HEIGHT))}},handleEvent:function(){var i=this;s("#apCLose").on("click",function(){i.closeModule()})}},s.fn.addressPlugin=function(i){return new e(s(this),i)}}(jQuery,window,document);