!function(o,i,t){function e(i,t){this.el=i,this.opts={datas:t.datas||[],title:t.title||"请选择",titlePos:t.titlePos||"center",callback:t.callback||void 0},0!=this.opts.datas.length&&(provinceObj={},cityList=[],cityObj={},zoonList=[],zoonObj={},finalProvince={},finalCity={},finalZoon={},finalCityList=[],finalZoonList=[],apProvinceTitleObj=null,apCityTitleObj=null,apZoonTitleObj=null,apPCZListObj=null,this.init(),this.openModule=function(i){if(console.log(i),o("#addressModule").css("display","block"),o("#addressList").removeClass("ap-pop-out").addClass("ap-pop-in"),i){var t=i.split("-");this.resetChoosedInfo(t)}else this.refreshCurrentView(this.opts.datas,"province",this.apProvinceTitleObj),this.apProvinceTitleObj.text("请选择"),this.apCityTitleObj.addClass("ap-none"),this.apZoonTitleObj.addClass("ap-none"),this.apPCZListObj.scrollTop(0)})}ANIMATION_OUT=300,MAX_SHOW_ITEMNUM=10,ITEM_HEIGHT=30,e.prototype={constructor:e,init:function(){this.drawDom(),this.handleEvent()},drawDom:function(){var i=this,t="",e="";"left"==i.opts.titlePos?e='<div class="ap-title-wrap" style="text-align: left; padding-left: .9375rem;">':"center"==i.opts.titlePos&&(e='<div class="ap-title-wrap" style="text-align: '+this.opts.titlePos+'">'),t+='<div id="addressModule" class="ap-container"><div id="addressList" class="ap-addrlist"><div class="ap-title">'+e+'<div class="ap-title-content">'+i.opts.title+'</div><div id="apCLose" class="ap-close"></div></div></div><div class="ap-choose-area"><div id="apChooseProvince" class="ap-choose-pcz ap-box-shaw" data-province="000000">请选择</div><div id="apChooseCity" class="ap-choose-pcz ap-none" data-city="000000">请选择</div><div id="apChooseZoon" class="ap-choose-pcz ap-none" data-zoon="000000">请选择</div></div><div id="apPCZList" class="ap-pcz-list"></div></div></div>',i.el.html(t),i.initTitleAndListObj(),i.refreshCurrentView(i.opts.datas,"province",i.apProvinceTitleObj)},initTitleAndListObj:function(){this.apProvinceTitleObj=o("#apChooseProvince"),this.apCityTitleObj=o("#apChooseCity"),this.apZoonTitleObj=o("#apChooseZoon"),this.apPCZListObj=o("#apPCZList")},changeTitleInfo:function(i,t,e,a){if(i){var o=!1,s=!1,n=!1;switch(i){case"province":o=!0;break;case"city":o=s=!0;break;case"zoon":o=s=n=!0}o&&(t.text(this.finalProvince.provinceName),t.attr("data-province",this.finalProvince.provinceId)),s&&(e.text(this.finalCity.cityName),e.attr("data-city",this.finalCity.cityId)),n&&(a.text(this.finalZoon.zoonName),a.attr("data-zoon",this.finalZoon.zoonId))}},setFinalPCZInfo:function(i){if(i&&0!=i.length){for(var t=0;t<this.opts.datas.length;t++)if(this.opts.datas[t].provinceName==i[0]){this.finalProvince=this.opts.datas[t],this.provinceObj=this.finalProvince;break}if(2==i.length){this.finalCityList=this.finalProvince.city,this.cityList=this.finalCityList;for(var e=0;e<this.finalCityList.length;e++)if(this.finalCityList[e].cityName==i[1]){this.finalCity=this.finalCityList[e],this.cityObj=this.finalCity;break}}if(3==i.length){this.finalZoonList=this.finalCity.zoon,this.zoonList=this.finalZoonList;for(var a=0;a<this.finalZoonList.length;a++)if(this.finalZoonList[a].zoonName==i[2]){this.finalZoon=this.finalZoonList[a],this.zoonObj=this.finalZoon;break}}}},resetChoosedInfo:function(i){this.setFinalPCZInfo(i),o.isEmptyObject(this.finalZoon)?(this.apZoonTitleObj.addClass("ap-none"),o.isEmptyObject(this.finalCity)?(this.apCityTitleObj.addClass("ap-none"),o.isEmptyObject(this.finalProvince)||(this.apProvinceTitleObj.removeClass("ap-none"),this.changeTitleInfo("province",this.apProvinceTitleObj,this.apCityTitleObj,this.apZoonTitleObj),this.rePaintDom(this.opts.datas,"province"),this.setCurrentItem(this.opts.datas,"province",this.apProvinceTitleObj,this.finalProvince.provinceId))):(this.apCityTitleObj.removeClass("ap-none"),this.apProvinceTitleObj.removeClass("ap-none"),this.changeTitleInfo("city",this.apProvinceTitleObj,this.apCityTitleObj,this.apZoonTitleObj),this.rePaintDom(this.finalCityList,"city"),this.setCurrentItem(this.finalCityList,"city",this.apCityTitleObj,this.finalCity.cityId))):(this.apProvinceTitleObj.removeClass("ap-none"),this.apCityTitleObj.removeClass("ap-none"),this.apZoonTitleObj.removeClass("ap-none"),this.changeTitleInfo("zoon",this.apProvinceTitleObj,this.apCityTitleObj,this.apZoonTitleObj),this.rePaintDom(this.finalZoonList,"zoon"),this.setCurrentItem(this.finalZoonList,"zoon",this.apZoonTitleObj,this.finalZoon.zoonId))},rebackPCZObj:function(){this.provinceObj=this.finalProvince,this.cityObj=this.finalCity,this.zoonObj=this.finalZoon,this.cityList=this.finalCityList,this.zoonList=this.finalZoonList},closeModule:function(){o("#addressList").addClass("ap-pop-out").removeClass("ap-pop-in"),setTimeout(function(){o("#addressModule").css("display","none")},ANIMATION_OUT),this.rebackPCZObj()},rollBackStatus:function(){o(".ap-pcz-iteminner").removeClass("apitem-active"),o(".ap-chooseimg").addClass("ap-unvisible"),o(".ap-choose-pcz").removeClass("ap-box-shaw")},setPCZObject:function(i,t,e){if(i&&t&&e&&0!=e.length)for(var a=0;a<e.length;a++)switch(i){case"province":if(e[a].provinceId==t)return void(this.provinceObj=e[a]);break;case"city":if(e[a].cityId==t)return void(this.cityObj=e[a]);break;case"zoon":if(e[a].zoonId==t)return void(this.zoonObj=e[a])}},composeHtml:function(i,t,e){return i&&t&&e?"province"==e?'<div class="ap-pcz-item ap-province" data-pczid='+i+'><div class="ap-pcz-iteminner">'+t+'</div><div class="ap-chooseimg ap-unvisible"></div></div>':'<div class="ap-pcz-item" data-pczid='+i+'><div class="ap-pcz-iteminner">'+t+'</div><div class="ap-chooseimg ap-unvisible"></div></div>':""},rePaintDom:function(i,t){if(i&&0!=i.length&&t){var e="",a=this.apPCZListObj;switch(a.empty(),this.setTitleStatusOrigin(),t){case"province":for(var o=0;o<i.length;o++)e+=this.composeHtml(i[o].provinceId,i[o].provinceName,"province");return a.append(e),void this.handlerProvinceItem();case"city":for(var s=0;s<i.length;s++)e+=this.composeHtml(i[s].cityId,i[s].cityName,"city");return a.append(e),void this.handlerCityItem();case"zoon":for(var n=0;n<i.length;n++)e+=this.composeHtml(i[n].zoonId,i[n].zoonName,"zoon");return a.append(e),void this.handlerZoonItem();default:return}}},handlePCZItemCommEvent:function(i,t,e,a){this.rollBackStatus(),i.addClass("apitem-active").removeClass("ap-box-shaw"),i.next().removeClass("ap-unvisible"),this.setPCZObject(e,i.parent().attr("data-pczid"),a),t.text(i.text())},changeActivePos:function(i){this.setTitleStatusOrigin(),i.addClass("ap-box-shaw").addClass("apitem-active")},setTitleStatusOrigin:function(){o(".ap-choose-pcz").removeClass("ap-box-shaw").removeClass("apitem-active")},refreshCurrentView:function(i,t,e){i&&0!=i.length&&t&&(this.rePaintDom(i,t),this.changeActivePos(e))},showOrHideTitle:function(i,t){i&&(t?i.removeClass("ap-none"):i.addClass("ap-none"))},returnChooseAddress:function(){var i=this.finalProvince&&this.finalProvince.provinceName,t=this.finalProvince&&this.finalProvince.provinceId,e=this.finalCity&&this.finalCity.cityName,a=this.finalCity&&this.finalCity.cityId,o=this.finalZoon&&this.finalZoon.zoonName,s=this.finalZoon&&this.finalZoon.zoonId,n="",l="";return i&&(n+=i,l+=t),e&&(n+="-"+e,l+="-"+a),o&&(n+="-"+o,l+="-"+s),{name:n,id:l}},setCurrentItem:function(i,t,e,a){i&&0!=i.length&&t&&0!=e.length&&a&&(this.refreshCurrentView(i,t,e),this.chooseApItem(a,i.length))},setPCZData:function(i,t,e,a,o){this.finalProvince=i||{},this.finalCity=t||{},this.finalZoon=e||{},this.finalCityList=a||[],this.finalZoonList=o||[]},handlerProvinceItem:function(){var t=this;o(".ap-pcz-iteminner").on("click",function(i){t.handlePCZItemCommEvent(o(this),t.apProvinceTitleObj,"province",t.opts.datas),t.apProvinceTitleObj.attr("data-province",t.provinceObj.provinceId),t.cityList=t.provinceObj.city,0==t.cityList.length?(t.cityObj={},t.zoonObj={},t.setPCZData(t.provinceObj,{},{},[],[]),t.apProvinceTitleObj.addClass("apitem-active").addClass("ap-box-shaw"),t.opts.callback&&t.opts.callback(t.returnChooseAddress()),t.closeModule()):(t.rePaintDom(t.cityList,"city"),t.apCityTitleObj.removeClass("ap-none").addClass("ap-box-shaw"),t.showOrHideTitle(t.apZoonTitleObj,!1),t.apCityTitleObj.text("请选择"),t.apCityTitleObj.attr("data-city","000000"),t.apZoonTitleObj.text("请选择"),t.apZoonTitleObj.attr("data-zoon","000000"))}),t.apProvinceTitleObj.on("click",function(){t.apProvinceTitleObj.hasClass("apitem-active")||t.setCurrentItem(t.opts.datas,"province",t.apProvinceTitleObj,t.apProvinceTitleObj.attr("data-province"))})},handlerCityItem:function(){var t=this;o(".ap-pcz-iteminner").on("click",function(i){t.handlePCZItemCommEvent(o(this),t.apCityTitleObj,"city",t.cityList),t.apCityTitleObj.attr("data-city",t.cityObj.cityId),t.zoonList=t.cityObj.zoon,0==t.zoonList.length?(t.setPCZData(t.provinceObj,t.cityObj,{},t.cityList,[]),t.zoonObj={},t.apCityTitleObj.addClass("apitem-active").addClass("ap-box-shaw"),t.opts.callback&&t.opts.callback(t.returnChooseAddress()),t.closeModule()):(t.rePaintDom(t.zoonList,"zoon"),t.apZoonTitleObj.removeClass("ap-none").addClass("ap-box-shaw"),t.apZoonTitleObj.text("请选择"),t.apZoonTitleObj.attr("data-zoon","000000"))}),t.apCityTitleObj.on("click",function(){t.apCityTitleObj.hasClass("apitem-active")||t.setCurrentItem(t.cityList,"city",t.apCityTitleObj,t.apCityTitleObj.attr("data-city"))})},handlerZoonItem:function(){var t=this;o(".ap-pcz-iteminner").on("click",function(i){t.handlePCZItemCommEvent(o(this),t.apZoonTitleObj,"zoon",t.zoonList),t.apZoonTitleObj.addClass("apitem-active").addClass("ap-box-shaw"),t.apZoonTitleObj.attr("data-zoon",t.zoonObj.zoonId),t.setPCZData(t.provinceObj,t.cityObj,t.zoonObj,t.cityList,t.zoonList),t.opts.callback&&t.opts.callback(t.returnChooseAddress()),t.closeModule()}),t.apZoonTitleObj.on("click",function(){t.apZoonTitleObj.hasClass("apitem-active")||t.setCurrentItem(t.zoonList,"zoon",t.apZoonTitleObj,t.apZoonTitleObj.attr("data-zoon"))})},chooseApItem:function(i,t){if(i&&"000000"!=i){var e=o("[data-pczid="+i+"]"),a=e.index()+1;e.children().eq(0).addClass("apitem-active"),e.children().eq(1).removeClass("ap-unvisible"),t>MAX_SHOW_ITEMNUM&&(a<MAX_SHOW_ITEMNUM?a<=t-MAX_SHOW_ITEMNUM?this.apPCZListObj.scrollTop((a-1)*ITEM_HEIGHT):this.apPCZListObj.scrollTop((t-MAX_SHOW_ITEMNUM)*ITEM_HEIGHT):t-a>MAX_SHOW_ITEMNUM-1?this.apPCZListObj.scrollTop(MAX_SHOW_ITEMNUM*parseInt(t/MAX_SHOW_ITEMNUM)*ITEM_HEIGHT):this.apPCZListObj.scrollTop(MAX_SHOW_ITEMNUM*ITEM_HEIGHT))}},handleEvent:function(){var i=this;o("#apCLose").on("click",function(){i.closeModule()})}},o.fn.addressPlugin=function(i){return new e(o(this),i)}}(jQuery,window,document);