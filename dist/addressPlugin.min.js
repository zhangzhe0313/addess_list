!function(a,i,t){function o(i,t){this.el=i,this.opts={datas:t.datas||[],title:t.title||"请选择",titlePos:t.titlePos||"center",showColumn:t.showColumn||3,callback:t.callback||void 0},0!=this.opts.datas.length&&(provinceObj={},cityList=[],cityObj={},zoonList=[],zoonObj={},finalProvince={},finalCity={},finalZoon={},finalCityList=[],finalZoonList=[],apProvinceTitleObj=null,apCityTitleObj=null,apZoonTitleObj=null,apPCZListObj=null,this.init(),this.openModule=function(i){if(console.log(i),a("#addressModule").css("display","block"),a("#addressList").removeClass("ap-pop-out").addClass("ap-pop-in"),i){var t=i.split("-");this.resetChoosedInfo(t)}else this.refreshCurrentView(this.opts.datas,"province",this.apProvinceTitleObj),this.apProvinceTitleObj.text("请选择"),this.apCityTitleObj.addClass("ap-none"),this.apZoonTitleObj.addClass("ap-none"),this.apPCZListObj.scrollTop(0)})}ANIMATION_OUT=300,MAX_SHOW_ITEMNUM=10,ITEM_HEIGHT=30,o.prototype={constructor:o,init:function(){this.drawDom(),this.handleEvent()},drawDom:function(){var i=this,t="",o="";"left"==i.opts.titlePos?o='<div class="ap-title-wrap" style="text-align: left; padding-left: .9375rem;">':"center"==i.opts.titlePos&&(o='<div class="ap-title-wrap" style="text-align: '+this.opts.titlePos+'">'),t+='<div id="addressModule" class="ap-container"><div id="addressList" class="ap-addrlist"><div class="ap-title">'+o+'<div class="ap-title-content">'+i.opts.title+'</div><div id="apCLose" class="ap-close"></div></div></div><div class="ap-choose-area"><div id="apChooseProvince" class="ap-choose-pcz ap-box-shaw" data-province="000000">请选择</div><div id="apChooseCity" class="ap-choose-pcz ap-none" data-city="000000">请选择</div><div id="apChooseZoon" class="ap-choose-pcz ap-none" data-zoon="000000">请选择</div></div><div id="apPCZList" class="ap-pcz-list"></div></div></div>',i.el.html(t),i.initTitleAndListObj(),i.refreshCurrentView(i.opts.datas,"province",i.apProvinceTitleObj)},initTitleAndListObj:function(){this.apProvinceTitleObj=a("#apChooseProvince"),this.apCityTitleObj=a("#apChooseCity"),this.apZoonTitleObj=a("#apChooseZoon"),this.apPCZListObj=a("#apPCZList")},changeTitleInfo:function(i,t,o,e){if(i){var a=!1,s=!1,n=!1;switch(i){case"province":a=!0;break;case"city":a=s=!0;break;case"zoon":a=s=n=!0}a&&(t.text(this.finalProvince.provinceName),t.attr("data-province",this.finalProvince.provinceId)),s&&(o.text(this.finalCity.cityName),o.attr("data-city",this.finalCity.cityId)),n&&(e.text(this.finalZoon.zoonName),e.attr("data-zoon",this.finalZoon.zoonId))}},setFinalPCZInfo:function(i){if(i&&0!=i.length){for(var t=0;t<this.opts.datas.length;t++)if(this.opts.datas[t].provinceName==i[0]){this.finalProvince=this.opts.datas[t],this.provinceObj=this.finalProvince;break}if(2==i.length){this.finalCityList=this.finalProvince.city,this.cityList=this.finalCityList;for(var o=0;o<this.finalCityList.length;o++)if(this.finalCityList[o].cityName==i[1]){this.finalCity=this.finalCityList[o],this.cityObj=this.finalCity;break}}if(3==i.length){this.finalZoonList=this.finalCity.zoon,this.zoonList=this.finalZoonList;for(var e=0;e<this.finalZoonList.length;e++)if(this.finalZoonList[e].zoonName==i[2]){this.finalZoon=this.finalZoonList[e],this.zoonObj=this.finalZoon;break}}}},resetChoosedInfo:function(i){this.setFinalPCZInfo(i),a.isEmptyObject(this.finalZoon)?(this.apZoonTitleObj.addClass("ap-none"),a.isEmptyObject(this.finalCity)?(this.apCityTitleObj.addClass("ap-none"),a.isEmptyObject(this.finalProvince)||(this.apProvinceTitleObj.removeClass("ap-none"),this.changeTitleInfo("province",this.apProvinceTitleObj,this.apCityTitleObj,this.apZoonTitleObj),this.rePaintDom(this.opts.datas,"province"),this.setCurrentItem(this.opts.datas,"province",this.apProvinceTitleObj,this.finalProvince.provinceId))):(this.apCityTitleObj.removeClass("ap-none"),this.apProvinceTitleObj.removeClass("ap-none"),this.changeTitleInfo("city",this.apProvinceTitleObj,this.apCityTitleObj,this.apZoonTitleObj),this.rePaintDom(this.finalCityList,"city"),this.setCurrentItem(this.finalCityList,"city",this.apCityTitleObj,this.finalCity.cityId))):(this.apProvinceTitleObj.removeClass("ap-none"),this.apCityTitleObj.removeClass("ap-none"),this.apZoonTitleObj.removeClass("ap-none"),this.changeTitleInfo("zoon",this.apProvinceTitleObj,this.apCityTitleObj,this.apZoonTitleObj),this.rePaintDom(this.finalZoonList,"zoon"),this.setCurrentItem(this.finalZoonList,"zoon",this.apZoonTitleObj,this.finalZoon.zoonId))},rebackPCZObj:function(){this.provinceObj=this.finalProvince,this.cityObj=this.finalCity,this.zoonObj=this.finalZoon,this.cityList=this.finalCityList,this.zoonList=this.finalZoonList},closeModule:function(){a("#addressList").addClass("ap-pop-out").removeClass("ap-pop-in"),setTimeout(function(){a("#addressModule").css("display","none")},ANIMATION_OUT),this.rebackPCZObj()},rollBackStatus:function(){a(".ap-pcz-iteminner").removeClass("apitem-active"),a(".ap-chooseimg").addClass("ap-unvisible"),a(".ap-choose-pcz").removeClass("ap-box-shaw")},setPCZObject:function(i,t,o){if(i&&t&&o&&0!=o.length)for(var e=0;e<o.length;e++)switch(i){case"province":if(o[e].provinceId==t)return void(this.provinceObj=o[e]);break;case"city":if(o[e].cityId==t)return void(this.cityObj=o[e]);break;case"zoon":if(o[e].zoonId==t)return void(this.zoonObj=o[e])}},composeHtml:function(i,t,o){return i&&t&&o?"province"==o?'<div class="ap-pcz-item ap-province" data-pczid='+i+'><div class="ap-pcz-iteminner">'+t+'</div><div class="ap-chooseimg ap-unvisible"></div></div>':'<div class="ap-pcz-item" data-pczid='+i+'><div class="ap-pcz-iteminner">'+t+'</div><div class="ap-chooseimg ap-unvisible"></div></div>':""},rePaintDom:function(i,t){if(i&&0!=i.length&&t){var o="",e=this.apPCZListObj;switch(e.empty(),this.setTitleStatusOrigin(),t){case"province":for(var a=0;a<i.length;a++)o+=this.composeHtml(i[a].provinceId,i[a].provinceName,"province");return e.append(o),void this.handlerProvinceItem();case"city":for(var s=0;s<i.length;s++)o+=this.composeHtml(i[s].cityId,i[s].cityName,"city");return e.append(o),void this.handlerCityItem();case"zoon":for(var n=0;n<i.length;n++)o+=this.composeHtml(i[n].zoonId,i[n].zoonName,"zoon");return e.append(o),void this.handlerZoonItem();default:return}}},handlePCZItemCommEvent:function(i,t,o,e){this.rollBackStatus(),i.addClass("apitem-active").removeClass("ap-box-shaw"),i.next().removeClass("ap-unvisible"),this.setPCZObject(o,i.parent().attr("data-pczid"),e),t.text(i.text())},changeActivePos:function(i){this.setTitleStatusOrigin(),i.addClass("ap-box-shaw").addClass("apitem-active")},setTitleStatusOrigin:function(){a(".ap-choose-pcz").removeClass("ap-box-shaw").removeClass("apitem-active")},refreshCurrentView:function(i,t,o){i&&0!=i.length&&t&&(this.rePaintDom(i,t),this.changeActivePos(o))},showOrHideTitle:function(i,t){i&&(t?i.removeClass("ap-none"):i.addClass("ap-none"))},returnChooseAddress:function(){var i=this.finalProvince&&this.finalProvince.provinceName,t=this.finalProvince&&this.finalProvince.provinceId,o=this.finalCity&&this.finalCity.cityName,e=this.finalCity&&this.finalCity.cityId,a=this.finalZoon&&this.finalZoon.zoonName,s=this.finalZoon&&this.finalZoon.zoonId,n="",l="";return i&&(n+=i,l+=t),o&&(n+="-"+o,l+="-"+e),a&&(n+="-"+a,l+="-"+s),{name:n,id:l}},setCurrentItem:function(i,t,o,e){i&&0!=i.length&&t&&0!=o.length&&e&&(this.refreshCurrentView(i,t,o),this.chooseApItem(e,i.length))},setPCZData:function(i,t,o,e,a){this.finalProvince=i||{},this.finalCity=t||{},this.finalZoon=o||{},this.finalCityList=e||[],this.finalZoonList=a||[]},handlerProvinceItem:function(){var t=this;a(".ap-pcz-iteminner").on("click",function(i){t.handlePCZItemCommEvent(a(this),t.apProvinceTitleObj,"province",t.opts.datas),t.apProvinceTitleObj.attr("data-province",t.provinceObj.provinceId),t.cityList=t.provinceObj.city,0==t.cityList.length||1==t.opts.showColumn?(t.cityObj={},t.zoonObj={},t.setPCZData(t.provinceObj,{},{},[],[]),t.apProvinceTitleObj.addClass("apitem-active").addClass("ap-box-shaw"),t.opts.callback&&t.opts.callback(t.returnChooseAddress()),t.closeModule()):(t.rePaintDom(t.cityList,"city"),t.apCityTitleObj.removeClass("ap-none").addClass("ap-box-shaw"),t.showOrHideTitle(t.apZoonTitleObj,!1),t.apCityTitleObj.text("请选择"),t.apCityTitleObj.attr("data-city","000000"),t.apZoonTitleObj.text("请选择"),t.apZoonTitleObj.attr("data-zoon","000000"))}),t.apProvinceTitleObj.on("click",function(){t.apProvinceTitleObj.hasClass("apitem-active")||t.setCurrentItem(t.opts.datas,"province",t.apProvinceTitleObj,t.apProvinceTitleObj.attr("data-province"))})},handlerCityItem:function(){var t=this;a(".ap-pcz-iteminner").on("click",function(i){t.handlePCZItemCommEvent(a(this),t.apCityTitleObj,"city",t.cityList),t.apCityTitleObj.attr("data-city",t.cityObj.cityId),t.zoonList=t.cityObj.zoon,0==t.zoonList.length||2==t.opts.showColumn?(t.setPCZData(t.provinceObj,t.cityObj,{},t.cityList,[]),t.zoonObj={},t.apCityTitleObj.addClass("apitem-active").addClass("ap-box-shaw"),t.opts.callback&&t.opts.callback(t.returnChooseAddress()),t.closeModule()):(t.rePaintDom(t.zoonList,"zoon"),t.apZoonTitleObj.removeClass("ap-none").addClass("ap-box-shaw"),t.apZoonTitleObj.text("请选择"),t.apZoonTitleObj.attr("data-zoon","000000"))}),t.apCityTitleObj.on("click",function(){t.apCityTitleObj.hasClass("apitem-active")||t.setCurrentItem(t.cityList,"city",t.apCityTitleObj,t.apCityTitleObj.attr("data-city"))})},handlerZoonItem:function(){var t=this;a(".ap-pcz-iteminner").on("click",function(i){t.handlePCZItemCommEvent(a(this),t.apZoonTitleObj,"zoon",t.zoonList),t.apZoonTitleObj.addClass("apitem-active").addClass("ap-box-shaw"),t.apZoonTitleObj.attr("data-zoon",t.zoonObj.zoonId),t.setPCZData(t.provinceObj,t.cityObj,t.zoonObj,t.cityList,t.zoonList),t.opts.callback&&t.opts.callback(t.returnChooseAddress()),t.closeModule()}),t.apZoonTitleObj.on("click",function(){t.apZoonTitleObj.hasClass("apitem-active")||t.setCurrentItem(t.zoonList,"zoon",t.apZoonTitleObj,t.apZoonTitleObj.attr("data-zoon"))})},chooseApItem:function(i,t){if(i&&"000000"!=i){var o=a("[data-pczid="+i+"]"),e=o.index()+1;o.children().eq(0).addClass("apitem-active"),o.children().eq(1).removeClass("ap-unvisible"),t>MAX_SHOW_ITEMNUM&&(e<MAX_SHOW_ITEMNUM?e<=t-MAX_SHOW_ITEMNUM?this.apPCZListObj.scrollTop((e-1)*ITEM_HEIGHT):this.apPCZListObj.scrollTop((t-MAX_SHOW_ITEMNUM)*ITEM_HEIGHT):t-e>MAX_SHOW_ITEMNUM-1?this.apPCZListObj.scrollTop(MAX_SHOW_ITEMNUM*parseInt(t/MAX_SHOW_ITEMNUM)*ITEM_HEIGHT):this.apPCZListObj.scrollTop(MAX_SHOW_ITEMNUM*ITEM_HEIGHT))}},handleEvent:function(){var i=this;a("#apCLose").on("click",function(){i.closeModule()})}},a.fn.addressPlugin=function(i){return new o(a(this),i)}}(jQuery,window,document);